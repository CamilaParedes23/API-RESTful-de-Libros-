{
	"info": {
		"_postman_id": "a1b2c3d4-e5f6-7890-1234-567890abcdef",
		"name": "Libros API - CRUD Complete Testing",
		"description": "Colecci√≥n completa de pruebas para la API RESTful de Libros\n\nIncluye:\n- Tests CRUD completos\n- Validaciones de errores\n- Casos exitosos y fallidos\n- Variables de entorno din√°micas\n\nConfiguraci√≥n requerida:\n- base_url: http://localhost:8080 (Docker) o http://localhost:8081 (Local)\n- libro_id: Se actualiza din√°micamente",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "12345678"
	},
	"item": [
		{
			"name": "üìö CRUD Operations",
			"item": [
				{
					"name": "1. ‚úÖ Crear Libro",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Response has success structure\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('success', true);",
									"    pm.expect(responseJson).to.have.property('message');",
									"    pm.expect(responseJson).to.have.property('data');",
									"    pm.expect(responseJson).to.have.property('timestamp');",
									"});",
									"",
									"pm.test(\"Book data is correct\", function () {",
									"    const responseJson = pm.response.json();",
									"    const book = responseJson.data;",
									"    pm.expect(book).to.have.property('id');",
									"    pm.expect(book.titulo).to.eql('Cien a√±os de soledad');",
									"    pm.expect(book.autor).to.eql('Gabriel Garc√≠a M√°rquez');",
									"    pm.expect(book.genero).to.eql('Realismo m√°gico');",
									"    ",
									"    // Guardar ID para pr√≥ximas pruebas",
									"    pm.environment.set('libro_id', book.id);",
									"});",
									"",
									"pm.test(\"Response time is less than 2000ms\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(2000);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"titulo\": \"Cien a√±os de soledad\",\n    \"autor\": \"Gabriel Garc√≠a M√°rquez\",\n    \"genero\": \"Realismo m√°gico\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/libros",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"libros"
							]
						}
					},
					"response": []
				},
				{
					"name": "2. ‚úÖ Listar Todos los Libros",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success structure\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('success', true);",
									"    pm.expect(responseJson).to.have.property('message');",
									"    pm.expect(responseJson).to.have.property('data');",
									"    pm.expect(responseJson.data).to.be.an('array');",
									"});",
									"",
									"pm.test(\"Books list contains created book\", function () {",
									"    const responseJson = pm.response.json();",
									"    const books = responseJson.data;",
									"    pm.expect(books.length).to.be.greaterThan(0);",
									"    ",
									"    const createdBook = books.find(book => book.titulo === 'Cien a√±os de soledad');",
									"    pm.expect(createdBook).to.not.be.undefined;",
									"});",
									"",
									"pm.test(\"Response time is less than 1000ms\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/libros",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"libros"
							]
						}
					},
					"response": []
				},
				{
					"name": "3. ‚úÖ Buscar Libro por ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success structure\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('success', true);",
									"    pm.expect(responseJson).to.have.property('message');",
									"    pm.expect(responseJson).to.have.property('data');",
									"});",
									"",
									"pm.test(\"Book data matches created book\", function () {",
									"    const responseJson = pm.response.json();",
									"    const book = responseJson.data;",
									"    pm.expect(book.titulo).to.eql('Cien a√±os de soledad');",
									"    pm.expect(book.autor).to.eql('Gabriel Garc√≠a M√°rquez');",
									"    pm.expect(book.genero).to.eql('Realismo m√°gico');",
									"});",
									"",
									"pm.test(\"Response time is less than 1000ms\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/libros/{{libro_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"libros",
								"{{libro_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "4. ‚úÖ Actualizar Libro",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success structure\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('success', true);",
									"    pm.expect(responseJson).to.have.property('message');",
									"    pm.expect(responseJson).to.have.property('data');",
									"});",
									"",
									"pm.test(\"Book data is updated correctly\", function () {",
									"    const responseJson = pm.response.json();",
									"    const book = responseJson.data;",
									"    pm.expect(book.titulo).to.eql('El Amor en los Tiempos del C√≥lera');",
									"    pm.expect(book.autor).to.eql('Gabriel Garc√≠a M√°rquez');",
									"    pm.expect(book.genero).to.eql('Romance');",
									"});",
									"",
									"pm.test(\"Response time is less than 2000ms\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(2000);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"titulo\": \"El Amor en los Tiempos del C√≥lera\",\n    \"autor\": \"Gabriel Garc√≠a M√°rquez\",\n    \"genero\": \"Romance\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/libros/{{libro_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"libros",
								"{{libro_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "5. ‚úÖ Crear Segundo Libro",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Second book created successfully\", function () {",
									"    const responseJson = pm.response.json();",
									"    const book = responseJson.data;",
									"    pm.expect(book.titulo).to.eql('1984');",
									"    pm.expect(book.autor).to.eql('George Orwell');",
									"    pm.expect(book.genero).to.eql('Distop√≠a');",
									"    ",
									"    // Guardar ID del segundo libro",
									"    pm.environment.set('segundo_libro_id', book.id);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"titulo\": \"1984\",\n    \"autor\": \"George Orwell\",\n    \"genero\": \"Distop√≠a\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/libros",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"libros"
							]
						}
					},
					"response": []
				},
				{
					"name": "6. ‚úÖ Eliminar Libro",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success structure\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('success', true);",
									"    pm.expect(responseJson).to.have.property('message');",
									"    pm.expect(responseJson.message).to.include('eliminado');",
									"});",
									"",
									"pm.test(\"Response time is less than 2000ms\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(2000);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/libros/{{libro_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"libros",
								"{{libro_id}}"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "‚ùå Error Cases",
			"item": [
				{
					"name": "‚ùå Crear Libro - Datos Inv√°lidos",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});",
									"",
									"pm.test(\"Response has error structure\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('success', false);",
									"    pm.expect(responseJson).to.have.property('message');",
									"    pm.expect(responseJson).to.have.property('data');",
									"});",
									"",
									"pm.test(\"Validation errors are present\", function () {",
									"    const responseJson = pm.response.json();",
									"    const errors = responseJson.data;",
									"    pm.expect(errors).to.be.an('object');",
									"    pm.expect(errors).to.have.property('titulo');",
									"    pm.expect(errors).to.have.property('autor');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"titulo\": \"\",\n    \"autor\": \"\",\n    \"genero\": \"a\".repeat(51)\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/libros",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"libros"
							]
						}
					},
					"response": []
				},
				{
					"name": "‚ùå Buscar Libro - ID No Existente",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 404\", function () {",
									"    pm.response.to.have.status(404);",
									"});",
									"",
									"pm.test(\"Response has error structure\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('success', false);",
									"    pm.expect(responseJson).to.have.property('message');",
									"    pm.expect(responseJson.message).to.include('no encontrado');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/libros/99999",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"libros",
								"99999"
							]
						}
					},
					"response": []
				},
				{
					"name": "‚ùå Buscar Libro - ID Inv√°lido",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});",
									"",
									"pm.test(\"Response has error structure\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('success', false);",
									"    pm.expect(responseJson).to.have.property('message');",
									"    pm.expect(responseJson.message).to.include('tipo');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/libros/invalid-id",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"libros",
								"invalid-id"
							]
						}
					},
					"response": []
				},
				{
					"name": "‚ùå Actualizar Libro - ID No Existente",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 404\", function () {",
									"    pm.response.to.have.status(404);",
									"});",
									"",
									"pm.test(\"Response has error structure\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('success', false);",
									"    pm.expect(responseJson).to.have.property('message');",
									"    pm.expect(responseJson.message).to.include('no encontrado');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"titulo\": \"Libro Actualizado\",\n    \"autor\": \"Autor Actualizado\",\n    \"genero\": \"G√©nero Actualizado\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/libros/99999",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"libros",
								"99999"
							]
						}
					},
					"response": []
				},
				{
					"name": "‚ùå Eliminar Libro - ID No Existente",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 404\", function () {",
									"    pm.response.to.have.status(404);",
									"});",
									"",
									"pm.test(\"Response has error structure\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('success', false);",
									"    pm.expect(responseJson).to.have.property('message');",
									"    pm.expect(responseJson.message).to.include('no encontrado');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/libros/99999",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"libros",
								"99999"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "üîç Health & Info",
			"item": [
				{
					"name": "‚úÖ Health Check",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Application is UP\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('status', 'UP');",
									"});",
									"",
									"pm.test(\"Database connection is healthy\", function () {",
									"    const responseJson = pm.response.json();",
									"    if (responseJson.components && responseJson.components.db) {",
									"        pm.expect(responseJson.components.db.status).to.eql('UP');",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/actuator/health",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"actuator",
								"health"
							]
						}
					},
					"response": []
				},
				{
					"name": "‚úÖ API Documentation",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"OpenAPI documentation is available\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('openapi');",
									"    pm.expect(responseJson).to.have.property('info');",
									"    pm.expect(responseJson).to.have.property('paths');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api-docs",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api-docs"
							]
						}
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Pre-request script global",
					"console.log('Ejecutando prueba en:', pm.environment.get('base_url'));"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Test script global",
					"pm.test(\"Response has valid JSON structure\", function () {",
					"    pm.response.to.be.json;",
					"});",
					"",
					"pm.test(\"Response has timestamp\", function () {",
					"    const responseJson = pm.response.json();",
					"    if (responseJson.timestamp) {",
					"        pm.expect(responseJson.timestamp).to.be.a('string');",
					"    }",
					"});"
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8080",
			"type": "string"
		},
		{
			"key": "libro_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "segundo_libro_id",
			"value": "2",
			"type": "string"
		}
	]
}

